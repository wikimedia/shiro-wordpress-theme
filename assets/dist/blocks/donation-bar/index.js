!function(){"use strict";var e={n:function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,{a:t}),t},d:function(n,t){for(var o in t)e.o(t,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:t[o]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}},n=window.wp.blocks,t=window.wp.blockEditor,o=window.wp.i18n,r=window.wp.serverSideRender,i=e.n(r),a=window.wp.components,l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"shiro/donation-portal-form","title":"Donation Portal Form","category":"wikimedia","icon":"money","description":"A form to direct users to donate.wikimedia.org portal","attributes":{"defaultAmount":{"type":"number","default":10,"min":1},"defaultCurrencyAmount":{"type":"array","items":{"type":"object","properties":{"currency":{"type":"string"},"amount":{"type":"number"}}},"default":[]},"fallbackText":{"type":"string","default":""},"showAnnual":{"type":"boolean","default":false},"medium":{"type":"string","default":"wmfSite"},"campaign":{"type":"string","default":"herobarButton"},"source":{"type":"string","default":"10"},"unsupportedCountries":{"type":"array","items":{"type":"string"},"default":["AE","AF","AX","BY","CD","CI","CU","FI","ID","IQ","IR","KP","KR","LB","LY","MM","PY","RU","SA","SD","SO","SS","SY","TM","TR","UA","UZ","XK","YE","ZW"]}},"example":{},"render":"file:/render.php","editorScript":"file:./index.js","style":"file:./index.css"}'),s=window.ReactJSXRuntime;const u=Object.entries(WMF_DONATION_FORM_BLOCK.currencies).map(([e,n])=>({label:`${e} (${n})`,value:e})),c=new Intl.DisplayNames([navigator.language||"en"],{type:"region"}),d=WMF_DONATION_FORM_BLOCK.countries.map(e=>({label:c.of(e),value:e}));(0,n.registerBlockType)(l.name,{...l,edit:function({attributes:e,isSelected:n,setAttributes:r}){const{defaultAmount:m,defaultCurrencyAmount:p=[],fallbackText:h,showAnnual:y,medium:f,campaign:x,source:g,unsupportedCountries:C}=e,b=(0,t.useBlockProps)({className:"donation-portal-form"}),_=(e,n,t)=>{const o=p.map((o,r)=>r===e?{...o,[n]:t}:o);r({defaultCurrencyAmount:o})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.InspectorControls,{children:[(0,s.jsxs)(a.PanelBody,{title:(0,o.__)("Donation Bar Settings","shiro-admin"),children:[(0,s.jsx)(a.TextControl,{label:(0,o.__)("Default Donation Amount","shiro-admin"),type:"number",min:"1",value:m,onChange:e=>r({defaultAmount:e})}),(0,s.jsx)(a.ToggleControl,{label:(0,o.__)("Show Annual Option","shiro-admin"),checked:y,onChange:()=>r({showAnnual:!y})}),(0,s.jsx)(a.TextControl,{label:(0,o.__)("UTM Medium","shiro-admin"),value:f,onChange:e=>r({medium:e})}),(0,s.jsx)(a.TextControl,{label:(0,o.__)("UTM Campaign","shiro-admin"),value:x,onChange:e=>r({campaign:e})}),(0,s.jsx)(a.TextControl,{label:(0,o.__)("UTM Source","shiro-admin"),value:g,onChange:e=>r({source:e})})]}),(0,s.jsxs)(a.PanelBody,{title:(0,o.__)("Default Amounts by Currency","shiro-admin"),children:[p.map((e,n)=>{const t=p.filter((e,t)=>t!==n).map(e=>e.currency),i=u.filter(n=>!t.includes(n.value)||n.value===e.currency);return(0,s.jsxs)(a.Flex,{align:"center",style:{marginBottom:8},children:[(0,s.jsx)(a.FlexItem,{children:(0,s.jsx)(a.SelectControl,{label:0===n?(0,o.__)("Currency","shiro-admin"):"",value:e.currency,options:i,onChange:e=>_(n,"currency",e),style:{width:120}})}),(0,s.jsx)(a.FlexItem,{children:(0,s.jsx)(a.TextControl,{label:0===n?(0,o.__)("Amount","shiro-admin"):"",type:"number",min:"1",value:e.amount,onChange:e=>_(n,"amount",Number(e)),placeholder:"10",style:{width:80}})}),(0,s.jsx)(a.FlexItem,{children:(0,s.jsx)(a.Button,{isDestructive:!0,icon:"no-alt",label:(0,o.__)("Remove","shiro-admin"),onClick:()=>(e=>{const n=p.filter((n,t)=>t!==e);r({defaultCurrencyAmount:n})})(n)})})]},n)}),(0,s.jsx)(a.Button,{variant:"secondary",onClick:()=>{const e=p.map(e=>e.currency),n=u.filter(n=>!e.includes(n.value));r({defaultCurrencyAmount:[...p,{currency:n[0].value,amount:10}]})},disabled:p.length>=u.length,children:(0,o.__)("Add Currency Amount","shiro-admin")})]}),(0,s.jsxs)(a.PanelBody,{title:(0,o.__)("Unsupported Countries","shiro-admin"),children:[(0,s.jsx)(a.ComboboxControl,{label:(0,o.__)("Add Unsupported Country","shiro-admin"),options:d.filter(e=>!(C||[]).includes(e.value)),placeholder:(0,o.__)("Search...","shiro-admin"),onChange:e=>{e&&!(C||[]).includes(e)&&r({unsupportedCountries:[...C||[],e]})}}),(C||[]).length>0&&(0,s.jsx)("ul",{style:{marginTop:12,paddingLeft:0},children:C.map(e=>(0,s.jsxs)("li",{style:{display:"flex",alignItems:"center",margin:0,listStyle:"none"},children:[(0,s.jsx)("span",{style:{flex:1},children:c.of(e)}),(0,s.jsx)(a.Button,{isDestructive:!0,icon:"no-alt",label:(0,o.__)("Remove","shiro-admin"),onClick:()=>{r({unsupportedCountries:C.filter(n=>n!==e)})},style:{marginLeft:8}})]},e))})]})]}),(0,s.jsxs)("div",{...b,children:[(0,s.jsx)(a.Disabled,{children:(0,s.jsx)(i(),{block:l.name,attributes:e})}),n&&(0,s.jsx)(t.RichText,{tagName:"p",placeholder:(0,o.__)("Fallback text for unsupported countries...","shiro-admin"),value:h,onChange:e=>r({fallbackText:e}),style:{marginTop:16,marginBottom:0}})]})]})}})}();