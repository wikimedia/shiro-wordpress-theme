!function(){"use strict";var e={n:function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,{a:t}),t},d:function(n,t){for(var r in t)e.o(t,r)&&!e.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:t[r]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}},n=window.wp.blocks,t=window.wp.blockEditor,r=window.wp.i18n,o=window.wp.serverSideRender,l=e.n(o),a=window.wp.components,i=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"shiro/donation-portal-form","title":"Donation Portal Form","category":"wikimedia","icon":"share","description":"A form to direct users to donate.wikimedia.org portal","attributes":{"defaultAmount":{"type":"number","default":10,"min":1},"defaultCurrencyAmount":{"type":"array","items":{"type":"object","properties":{"currency":{"type":"string"},"amount":{"type":"number"}}},"default":[]},"showAnnual":{"type":"boolean","default":false},"medium":{"type":"string","default":"wmfSite"},"campaign":{"type":"string","default":"herobarButton"},"source":{"type":"string","default":""}},"example":{},"render":"file:/render.php","editorScript":"file:./index.js","style":"file:./index.css"}'),u=window.ReactJSXRuntime;const s=Object.entries(DONATION_FORM_CURRENCIES).map((([e,n])=>({label:`${e} (${n})`,value:e})));(0,n.registerBlockType)(i.name,{...i,edit:function({attributes:e,setAttributes:n}){const{defaultAmount:o,defaultCurrencyAmount:c=[],showAnnual:d,medium:m,campaign:p,source:h}=e,y=(0,t.useBlockProps)({className:"donation-portal-form"}),f=(e,t,r)=>{const o=c.map(((n,o)=>o===e?{...n,[t]:r}:n));n({defaultCurrencyAmount:o})};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(t.InspectorControls,{children:[(0,u.jsxs)(a.PanelBody,{title:(0,r.__)("Donation Bar Settings","shiro"),children:[(0,u.jsx)(a.TextControl,{label:(0,r.__)("Default Donation Amount","shiro"),type:"number",min:"1",value:o,onChange:e=>n({defaultAmount:e})}),(0,u.jsx)(a.ToggleControl,{label:(0,r.__)("Show Annual Option","shiro"),checked:d,onChange:()=>n({showAnnual:!d})}),(0,u.jsx)(a.TextControl,{label:(0,r.__)("UTM Medium","shiro"),value:m,onChange:e=>n({medium:e})}),(0,u.jsx)(a.TextControl,{label:(0,r.__)("UTM Campaign","shiro"),value:p,onChange:e=>n({campaign:e})}),(0,u.jsx)(a.TextControl,{label:(0,r.__)("UTM Source","shiro"),value:h,onChange:e=>n({source:e})})]}),(0,u.jsxs)(a.PanelBody,{title:(0,r.__)("Default Amounts by Currency","shiro"),initialOpen:!1,children:[c.map(((e,t)=>{const o=c.filter(((e,n)=>n!==t)).map((e=>e.currency)),l=s.filter((n=>!o.includes(n.value)||n.value===e.currency));return(0,u.jsxs)(a.Flex,{align:"center",style:{marginBottom:8},children:[(0,u.jsx)(a.FlexItem,{children:(0,u.jsx)(a.SelectControl,{label:0===t?(0,r.__)("Currency","shiro"):"",value:e.currency,options:l,onChange:e=>f(t,"currency",e),style:{width:120}})}),(0,u.jsx)(a.FlexItem,{children:(0,u.jsx)(a.TextControl,{label:0===t?(0,r.__)("Amount","shiro"):"",type:"number",min:"1",value:e.amount,onChange:e=>f(t,"amount",Number(e)),placeholder:"10",style:{width:80}})}),(0,u.jsx)(a.FlexItem,{children:(0,u.jsx)(a.Button,{isDestructive:!0,icon:"no-alt",label:(0,r.__)("Remove","shiro"),onClick:()=>(e=>{const t=c.filter(((n,t)=>t!==e));n({defaultCurrencyAmount:t})})(t)})})]},t)})),(0,u.jsx)(a.Button,{variant:"secondary",onClick:()=>{const e=c.map((e=>e.currency)),t=s.filter((n=>!e.includes(n.value)));n({defaultCurrencyAmount:[...c,{currency:t[0].value,amount:10}]})},disabled:c.length>=s.length,children:(0,r.__)("Add Currency Amount","shiro")})]})]}),(0,u.jsx)("div",{...y,children:(0,u.jsx)(l(),{block:i.name,attributes:e})})]})}})}();